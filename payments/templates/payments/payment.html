{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<div class="checkout-wrapper">
    <div class="bg-blur-purple"></div>
    <div class="bg-blur-blue"></div>

    <div class="checkout-container">
        <header class="checkout-header">
            <a href="{% url 'products:list' %}" class="minimal-back">
                <i class="fas fa-chevron-left"></i> Return to Dashboard
            </a>
            <div class="brand-logo">DevOps<span>VaultX</span></div>
        </header>

        <main class="checkout-grid">
            <div class="product-info-side">
                <div class="badge-row">
                    <span class="status-dot"></span>
                    <span class="badge-text">Secure Access Node</span>
                </div>
                <h1 class="checkout-title">{{ product.title }}</h1>
                <p class="checkout-desc">Unlock full repository access, private documentation, and production-ready DevOps scripts instantly.</p>
                
                <ul class="benefit-list">
                    <li><i class="fas fa-check-circle"></i> Lifetime Updates</li>
                    <li><i class="fas fa-check-circle"></i> Private Community Access</li>
                    <li><i class="fas fa-check-circle"></i> 1-Click Vault Sync</li>
                </ul>
            </div>

            <div class="payment-action-side">
                <div class="payment-box">
                    <div class="price-display">
                        <label>Total Investment</label>
                        {% if is_free %}
                            <div class="amount-wrap free-mode">FREE ACCESS</div>
                        {% else %}
                            <div class="amount-wrap">
                                <span class="ccy">â‚¹</span>
                                <span class="val">{{ product.price }}</span>
                            </div>
                        {% endif %}
                    </div>

                    <div class="action-area">
                        <button id="pay-button" class="nexus-btn">
                            {% if is_free %}
                                <span>INITIALIZE UNLOCK</span> <i class="fas fa-bolt"></i>
                            {% else %}
                                <span>COMPLETE PAYMENT</span> <i class="fas fa-shield-halved"></i>
                            {% endif %}
                        </button>
                    </div>

                    <footer class="box-footer">
                        <div class="security-tag">
                            <i class="fas fa-lock"></i> AES-256 Encrypted
                        </div>
                        <div class="provider-logos">
                            <i class="fab fa-cc-visa"></i>
                            <i class="fab fa-cc-mastercard"></i>
                            <i class="fab fa-google-pay"></i>
                        </div>
                    </footer>
                </div>
            </div>
        </main>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script id="payment-data" type="application/json">
    {
        "csrfToken": "{{ csrf_token }}",
        "isFree": {{ is_free|yesno:"true,false" }},
        "razorpayOrderId": "{{ razorpay_order_id|default:'' }}",
        "razorpayKeyId": "{{ razorpay_key_id }}",
        "amount": "{{ amount }}",
        "productTitle": "{{ product.title }}",
        "successUrl": "{% url 'payments:payment_success' product.id %}"
    }
</script>

<script src="{% static 'payments/js/payment.js' %}"></script>
{% endblock %}